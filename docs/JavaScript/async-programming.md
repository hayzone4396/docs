---
title: JavaScript å¼‚æ­¥ç¼–ç¨‹å¯¼èˆª
createTime: 2026-01-28 11:00:00
tags:
  - JavaScript
  - å¼‚æ­¥ç¼–ç¨‹
  - Promise
  - Event Loop
permalink: /javascript/async-programming/
---

# JavaScript å¼‚æ­¥ç¼–ç¨‹å¯¼èˆª

## ğŸ“– æ¦‚è¿°

JavaScript æ˜¯ä¸€é—¨å•çº¿ç¨‹è¯­è¨€ï¼Œå¼‚æ­¥ç¼–ç¨‹æ˜¯å…¶æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ã€‚é€šè¿‡å¼‚æ­¥æœºåˆ¶ï¼ŒJavaScript å¯ä»¥åœ¨ç­‰å¾…è€—æ—¶æ“ä½œï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å–ï¼‰å®Œæˆæ—¶ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- **éé˜»å¡**ï¼šä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹çš„æ‰§è¡Œ
- **äº‹ä»¶é©±åŠ¨**ï¼šåŸºäºäº‹ä»¶å¾ªç¯æœºåˆ¶
- **å›è°ƒæœºåˆ¶**ï¼šé€šè¿‡å›è°ƒå‡½æ•°å¤„ç†å¼‚æ­¥ç»“æœ
- **Promise**ï¼šæ›´ä¼˜é›…çš„å¼‚æ­¥å¤„ç†æ–¹å¼
- **async/await**ï¼šåŒæ­¥é£æ ¼çš„å¼‚æ­¥ä»£ç 

## ğŸ¯ å­¦ä¹ è·¯å¾„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            JavaScript å¼‚æ­¥ç¼–ç¨‹å­¦ä¹ è·¯å¾„             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                   â”‚
â”‚  ç¬¬ä¸€æ­¥ï¼šç†è§£å¼‚æ­¥æœºåˆ¶                              â”‚
â”‚  â””â”€ JavaScript å¼‚æ­¥æœºåˆ¶æ·±åº¦è§£æ                    â”‚
â”‚                                                   â”‚
â”‚  ç¬¬äºŒæ­¥ï¼šæŒæ¡ Promise                             â”‚
â”‚  â””â”€ Promise å®Œå…¨æŒ‡å—                              â”‚
â”‚                                                   â”‚
â”‚  ç¬¬ä¸‰æ­¥ï¼šå®æˆ˜åº”ç”¨                                  â”‚
â”‚  â”œâ”€ æ ‡ç­¾åˆ‡æ¢ç«æ€æ¡ä»¶é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ                  â”‚
â”‚  â””â”€ WebSocket å®Œå…¨æŒ‡å—                            â”‚
â”‚                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“š æ·±åº¦æ–‡ç« 

### 1. JavaScript å¼‚æ­¥æœºåˆ¶æ·±åº¦è§£æ

**é€‚åˆäººç¾¤**ï¼šæƒ³æ·±å…¥ç†è§£äº‹ä»¶å¾ªç¯ã€å®ä»»åŠ¡ã€å¾®ä»»åŠ¡çš„å¼€å‘è€…

**æ ¸å¿ƒå†…å®¹**ï¼š
- JavaScript ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹ï¼Ÿ
- äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰å·¥ä½œåŸç†
- å®ä»»åŠ¡ï¼ˆMacro Taskï¼‰vs å¾®ä»»åŠ¡ï¼ˆMicro Taskï¼‰
- setTimeoutã€setInterval è®¡æ—¶å™¨åŸç†
- å¸¸è§é¢è¯•é¢˜è§£æ

**é˜…è¯»æ—¶é•¿**ï¼šçº¦ 15 åˆ†é’Ÿ

ğŸ‘‰ [é˜…è¯»å®Œæ•´æ–‡ç« ](./async-mechanism-deep-dive.md)

### 2. Promise å®Œå…¨æŒ‡å—

**é€‚åˆäººç¾¤**ï¼šæƒ³ç³»ç»Ÿå­¦ä¹  Promise çš„å¼€å‘è€…

**æ ¸å¿ƒå†…å®¹**ï¼š
- Promise çš„ä¸‰ç§çŠ¶æ€ï¼ˆPendingã€Fulfilledã€Rejectedï¼‰
- Promise A+ è§„èŒƒè¯¦è§£
- Promise é“¾å¼è°ƒç”¨åŸç†
- Promise é™æ€æ–¹æ³•ï¼ˆallã€raceã€allSettledã€anyï¼‰
- é”™è¯¯å¤„ç†æœ€ä½³å®è·µ
- æ‰‹å†™ Promise å®ç°

**é˜…è¯»æ—¶é•¿**ï¼šçº¦ 20 åˆ†é’Ÿ

ğŸ‘‰ [é˜…è¯»å®Œæ•´æ–‡ç« ](./promise.md)

### 3. æ ‡ç­¾åˆ‡æ¢ç«æ€æ¡ä»¶é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

**é€‚åˆäººç¾¤**ï¼šé‡åˆ°å¼‚æ­¥ç«æ€é—®é¢˜çš„å¼€å‘è€…

**æ ¸å¿ƒå†…å®¹**ï¼š
- ä»€ä¹ˆæ˜¯ç«æ€æ¡ä»¶ï¼ˆRace Conditionï¼‰
- æ ‡ç­¾åˆ‡æ¢åœºæ™¯çš„ç«æ€é—®é¢˜
- è§£å†³æ–¹æ¡ˆï¼šAbortControllerã€è¯·æ±‚æ ‡è¯†ã€é˜²æŠ–èŠ‚æµ
- React 18 çš„è§£å†³æ–¹æ¡ˆï¼ˆuseTransitionï¼‰

**é˜…è¯»æ—¶é•¿**ï¼šçº¦ 10 åˆ†é’Ÿ

ğŸ‘‰ [é˜…è¯»å®Œæ•´æ–‡ç« ](./tab-switch-race-condition.md)

### 4. WebSocket å®Œå…¨æŒ‡å—

**é€‚åˆäººç¾¤**ï¼šéœ€è¦å®æ—¶é€šä¿¡çš„å¼€å‘è€…

**æ ¸å¿ƒå†…å®¹**ï¼š
- WebSocket åè®®åŸç†
- WebSocket vs HTTP è½®è¯¢
- å¿ƒè·³æœºåˆ¶ä¸æ–­çº¿é‡è¿
- å®æˆ˜æ¡ˆä¾‹ï¼šèŠå¤©å®¤ã€å®æ—¶é€šçŸ¥

**é˜…è¯»æ—¶é•¿**ï¼šçº¦ 15 åˆ†é’Ÿ

ğŸ‘‰ [é˜…è¯»å®Œæ•´æ–‡ç« ](./websocket.md)

## ğŸ”§ å¿«é€Ÿå‚è€ƒ

### å¼‚æ­¥ç¼–ç¨‹çš„å‘å±•å†ç¨‹

```
å›è°ƒå‡½æ•°ï¼ˆCallbackï¼‰
    â†“
    é—®é¢˜ï¼šå›è°ƒåœ°ç‹±ï¼ˆCallback Hellï¼‰
    â†“
Promiseï¼ˆES6ï¼‰
    â†“
    ä¼˜åŠ¿ï¼šé“¾å¼è°ƒç”¨ã€é”™è¯¯å¤„ç†
    â†“
async/awaitï¼ˆES7ï¼‰
    â†“
    ä¼˜åŠ¿ï¼šåŒæ­¥é£æ ¼çš„å¼‚æ­¥ä»£ç 
```

### å¸¸è§å¼‚æ­¥åœºæ™¯

| åœºæ™¯ | æ¨èæ–¹æ¡ˆ | ç¤ºä¾‹æ–‡ç«  |
|------|---------|---------|
| **ç½‘ç»œè¯·æ±‚** | Promise + async/await | Promise å®Œå…¨æŒ‡å— |
| **å®šæ—¶ä»»åŠ¡** | setTimeout/setInterval | å¼‚æ­¥æœºåˆ¶æ·±åº¦è§£æ |
| **å®æ—¶é€šä¿¡** | WebSocket | WebSocket å®Œå…¨æŒ‡å— |
| **å¹¶å‘æ§åˆ¶** | Promise.all/allSettled | Promise å®Œå…¨æŒ‡å— |
| **ç«æ€å¤„ç†** | AbortController | æ ‡ç­¾åˆ‡æ¢ç«æ€é—®é¢˜ |

### äº‹ä»¶å¾ªç¯æ‰§è¡Œé¡ºåº

```javascript
console.log('1. åŒæ­¥ä»£ç ')

setTimeout(() => {
  console.log('4. å®ä»»åŠ¡ï¼ˆsetTimeoutï¼‰')
}, 0)

Promise.resolve().then(() => {
  console.log('3. å¾®ä»»åŠ¡ï¼ˆPromiseï¼‰')
})

console.log('2. åŒæ­¥ä»£ç ')

// è¾“å‡ºé¡ºåºï¼š1 â†’ 2 â†’ 3 â†’ 4
// åŸç†ï¼šåŒæ­¥ä»£ç  â†’ å¾®ä»»åŠ¡é˜Ÿåˆ— â†’ å®ä»»åŠ¡é˜Ÿåˆ—
```

### Promise åŸºæœ¬ç”¨æ³•

```javascript
// åˆ›å»º Promise
const promise = new Promise((resolve, reject) => {
  // å¼‚æ­¥æ“ä½œ
  setTimeout(() => {
    const success = true
    if (success) {
      resolve('æˆåŠŸçš„ç»“æœ')
    } else {
      reject('å¤±è´¥çš„åŸå› ')
    }
  }, 1000)
})

// ä½¿ç”¨ Promise
promise
  .then(result => console.log(result))
  .catch(error => console.error(error))
  .finally(() => console.log('å®Œæˆ'))
```

### async/await è¯­æ³•ç³–

```javascript
// Promise å†™æ³•
function fetchData() {
  return fetch('/api/data')
    .then(response => response.json())
    .then(data => {
      console.log(data)
      return data
    })
    .catch(error => {
      console.error(error)
    })
}

// async/await å†™æ³•ï¼ˆæ›´ç®€æ´ï¼‰
async function fetchData() {
  try {
    const response = await fetch('/api/data')
    const data = await response.json()
    console.log(data)
    return data
  } catch (error) {
    console.error(error)
  }
}
```

## ğŸ’¡ å­¦ä¹ å»ºè®®

### åˆå­¦è€…è·¯å¾„

1. **ç†è§£åŒæ­¥ vs å¼‚æ­¥**
   - ä» setTimeout å¼€å§‹ï¼Œç†è§£å¼‚æ­¥çš„æ¦‚å¿µ
   - é˜…è¯»ã€Šå¼‚æ­¥æœºåˆ¶æ·±åº¦è§£æã€‹çš„å‰åŠéƒ¨åˆ†

2. **æŒæ¡ Promise åŸºç¡€**
   - å­¦ä¹  Promise çš„ä¸‰ç§çŠ¶æ€
   - ç»ƒä¹  then/catch é“¾å¼è°ƒç”¨
   - é˜…è¯»ã€ŠPromise å®Œå…¨æŒ‡å—ã€‹

3. **å­¦ä¹  async/await**
   - ç†è§£ async/await æ˜¯ Promise çš„è¯­æ³•ç³–
   - ç»ƒä¹ æ”¹å†™ Promise ä»£ç ä¸º async/await

4. **å®æˆ˜ç»ƒä¹ **
   - å°è£…ç½‘ç»œè¯·æ±‚ï¼ˆfetch/axiosï¼‰
   - å®ç°é˜²æŠ–èŠ‚æµ
   - å¤„ç†å¹¶å‘è¯·æ±‚

### è¿›é˜¶è·¯å¾„

1. **æ·±å…¥äº‹ä»¶å¾ªç¯**
   - æŒæ¡å®ä»»åŠ¡ã€å¾®ä»»åŠ¡æ‰§è¡Œé¡ºåº
   - ç†è§£ Node.js äº‹ä»¶å¾ªç¯
   - è§£å†³å¤æ‚çš„æ‰§è¡Œé¡ºåºé—®é¢˜

2. **Promise é«˜çº§ç”¨æ³•**
   - æ‰‹å†™ Promise å®ç°
   - ç†è§£ Promise A+ è§„èŒƒ
   - æŒæ¡ Promise é™æ€æ–¹æ³•æºç 

3. **è§£å†³å®é™…é—®é¢˜**
   - ç«æ€æ¡ä»¶å¤„ç†
   - è¯·æ±‚å–æ¶ˆä¸è¶…æ—¶
   - å¹¶å‘æ§åˆ¶ä¸é˜Ÿåˆ—ç®¡ç†

## ğŸ”— ç›¸å…³èµ„æº

### æœ¬ç«™æ–‡ç« 

- [Promise å®Œå…¨æŒ‡å—](./promise.md) - ç³»ç»Ÿå­¦ä¹  Promise
- [JavaScript å¼‚æ­¥æœºåˆ¶æ·±åº¦è§£æ](./async-mechanism-deep-dive.md) - æ·±å…¥äº‹ä»¶å¾ªç¯
- [æ ‡ç­¾åˆ‡æ¢ç«æ€æ¡ä»¶é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](./tab-switch-race-condition.md) - å®æˆ˜æ¡ˆä¾‹
- [WebSocket å®Œå…¨æŒ‡å—](./websocket.md) - å®æ—¶é€šä¿¡
- [WebRTC å®Œå…¨æŒ‡å—](./webrtc.md) - è§†é¢‘é€šè¯

### å¤–éƒ¨èµ„æº

- [MDN - å¼‚æ­¥ JavaScript](https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Asynchronous)
- [JavaScript.info - Promise](https://javascript.info/promise-basics)
- [Promise A+ è§„èŒƒ](https://promisesaplus.com/)
- [Event Loop Visualizer](http://latentflip.com/loupe/) - äº‹ä»¶å¾ªç¯å¯è§†åŒ–

## ğŸ“ å¸¸è§é—®é¢˜

### Q1: Promise å’Œ async/await æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

async/await æ˜¯ Promise çš„è¯­æ³•ç³–ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯ Promiseã€‚åŒºåˆ«åœ¨äºï¼š
- **Promise**ï¼šé“¾å¼è°ƒç”¨ï¼Œthen/catch å¤„ç†
- **async/await**ï¼šåŒæ­¥é£æ ¼ï¼Œç”¨ try/catch å¤„ç†é”™è¯¯

ğŸ‘‰ è¯¦è§ [Promise å®Œå…¨æŒ‡å—](./promise.md)

### Q2: setTimeout(fn, 0) ä¸ºä»€ä¹ˆä¸æ˜¯ç«‹å³æ‰§è¡Œï¼Ÿ

å› ä¸º setTimeout æ˜¯å®ä»»åŠ¡ï¼Œå³ä½¿å»¶è¿Ÿè®¾ä¸º 0ï¼Œä¹Ÿè¦ç­‰å½“å‰åŒæ­¥ä»£ç å’Œå¾®ä»»åŠ¡é˜Ÿåˆ—æ‰§è¡Œå®Œæ¯•åæ‰ä¼šæ‰§è¡Œã€‚

ğŸ‘‰ è¯¦è§ [å¼‚æ­¥æœºåˆ¶æ·±åº¦è§£æ](./async-mechanism-deep-dive.md)

### Q3: å¦‚ä½•å–æ¶ˆä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„ Promiseï¼Ÿ

Promise æœ¬èº«ä¸æ”¯æŒå–æ¶ˆï¼Œä½†å¯ä»¥ä½¿ç”¨ AbortController é…åˆ fetch å®ç°è¯·æ±‚å–æ¶ˆã€‚

ğŸ‘‰ è¯¦è§ [æ ‡ç­¾åˆ‡æ¢ç«æ€æ¡ä»¶é—®é¢˜](./tab-switch-race-condition.md)

### Q4: Promise.all å’Œ Promise.allSettled æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

- **Promise.all**ï¼šæ‰€æœ‰ Promise éƒ½æˆåŠŸæ‰æˆåŠŸï¼Œæœ‰ä¸€ä¸ªå¤±è´¥å°±å¤±è´¥
- **Promise.allSettled**ï¼šç­‰å¾…æ‰€æœ‰ Promise å®Œæˆï¼ˆæ— è®ºæˆåŠŸæˆ–å¤±è´¥ï¼‰ï¼Œè¿”å›æ‰€æœ‰ç»“æœ

ğŸ‘‰ è¯¦è§ [Promise å®Œå…¨æŒ‡å—](./promise.md)

## ğŸ“ æ€»ç»“

JavaScript å¼‚æ­¥ç¼–ç¨‹æ˜¯å‰ç«¯å¼€å‘çš„æ ¸å¿ƒæŠ€èƒ½ã€‚å»ºè®®æŒ‰ç…§ä»¥ä¸‹é¡ºåºå­¦ä¹ ï¼š

1. ç†è§£å¼‚æ­¥æœºåˆ¶å’Œäº‹ä»¶å¾ªç¯
2. æŒæ¡ Promise å’Œ async/await
3. å­¦ä¹ å®æˆ˜ä¸­çš„å¼‚æ­¥åœºæ™¯
4. æ·±å…¥æºç å’Œè§„èŒƒ

å¸Œæœ›è¿™ä¸ªå¯¼èˆªé¡µèƒ½å¸®åŠ©ä½ ç³»ç»Ÿåœ°æŒæ¡ JavaScript å¼‚æ­¥ç¼–ç¨‹ï¼

---

**æ¨èé˜…è¯»é¡ºåº**ï¼š
1. [JavaScript å¼‚æ­¥æœºåˆ¶æ·±åº¦è§£æ](./async-mechanism-deep-dive.md)
2. [Promise å®Œå…¨æŒ‡å—](./promise.md)
3. [æ ‡ç­¾åˆ‡æ¢ç«æ€æ¡ä»¶é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](./tab-switch-race-condition.md)
